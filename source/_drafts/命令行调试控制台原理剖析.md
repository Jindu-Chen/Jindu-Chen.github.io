---
title: 嵌入式开发之命令行调试-Shell剖析
date: 2024-02-02
tags:
categories:
- [MCU]
- [嵌入式]
description: 日常在嵌入式软件开发中的调试方法包括有在线调试、日志打印、Shell 交互、BackTrace 等，其中 Shell 能够以命令行交互的方式直接访问系统信息或者执行系统功能函数，是辅助开发的调试利器之一，本文记录个人对嵌入式 Shell 的应用及理解。
---


## 前言


## 命令行交互概述

换行，tab等 标准功能 参照Shell

串口软件之按键键值映射，参照SecureCRT


## 引出命令行函数原理

原理大致是将要声明的命令行函数指针变量 声明至一个段中，而后将这个段编译至程序中，程序运行时，可以遍历这个段的函数指针，然后指向这个指针运行即可完成 命令行对这个函数的调用

至于函数名的保存，以及多种变量的调用，则

声明函数段、
在GCC或者Keil环境下的链接脚本要进行不同的配置，声明相关的段不要被编译器优化


## 实时操作系统下获取当前线程运行状态

线程栈最大使用率

CPU空闲率



## Shell 附加功能

### 日志输出

颜色的标准配置


### 密码设置原理

## Shell 移植适配（以Letter_Shell为例）



## 注意项及疑惑解答

避免串口回环，导致函数陷入死循环


## 参考站点

- [letter shell 3.x](https://github.com/NevermindZZT/letter-shell/blob/master/README.md)
- [letter-shell | 一个功能强大的嵌入式shell](https://zhuanlan.zhihu.com/p/128960695)



