---
title: Makefile相关学习笔记
date: 2023-12-06 01:45:35
tags:
- [make]
categories:
description: 记录Makefile基础学习与实际开发中所遇到的知识点
---


## 基础学习

### 符号
- 符号`$`
- 符号`@`
- 符号`<`

### Makefile格式


### 规则模式与语法

- 模式规则

- 常用函数

## 实际应用

- 在Makefile中，是如何将每个需要编译生成.o目标文件与.c源文件关联起来的
    ```
    # addprefix用于在每个元素前面添加一个前缀：(OUTPUT_DIR)/
    # (C_SOURCES:.c=.o)将C源文件的后缀.c替换为.o，使得C_SOURCES中的每个.c都对应相应的.o文件
    C_OBJECTS = $(addprefix $(OUTPUT_DIR)/, $(C_SOURCES:.c=.o))
    
    $(OUTPUT_DIR)/%.o: %.c              # 模式规则，要生成.o文件，则要找到对应的.c
        mkdir -p $(dir $@)              # 如果目录不存在，则创建；(dir@)表示目标文件$@的目录部分
        $(CC) $(INCLUDE) $(CFLAGS) -MMD -c $< -o $@
    ```
    <br>
- ./configure命令
    configure脚本由autoconf工具生成，在make命令之前先执行配置；执行此命令，配置编译器、库、工具等参数，并根据此参数生成一个Makefile
    <br>
    
- 编译、包含依赖文件，避免重复编译、提高效率
    在编译命令中加入`-MMD`选项，告诉编译器生成依赖关系文件
    在Makefile里的目标文件编译规则命令之后，加入`-include $(wildcard $(OUTPUT_DIR)/*/*.d)`
    
